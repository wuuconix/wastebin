<html>
    <head>
        <title>wastebin - light</title>
        <meta charset="utf-8" />
        <script src="/highlight.min.js"></script>
        <link rel="icon" href="https://img-blog.csdnimg.cn/e56dce0aa10247b2b82e984e0601a6cb.png">
    </head>
    <body>
        <pre><code></code></pre>
        <textarea spellcheck="false" autofocus></textarea>
    </body>
</html>

<script>
    const pathname = window.location.pathname.slice(1)
    const head = document.querySelector("head")
    const body = document.querySelector("body")
    const textarea = document.querySelector("textarea")
    const title = document.querySelector("title")
    if(window.location.hash == "#dark") {
        const link = document.createElement("link")
        link.rel = "stylesheet"
        link.href = "/onedark.css"
        head.appendChild(link)
        body.style.backgroundColor = "#282c34"
        textarea.style.color = "white"
        title.textContent = "wastebin - dark"
    } else { //如果不是#dark 则设置为light模式
        window.location.hash = "#light"
        const link = document.createElement("link")
        link.rel = "stylesheet"
        link.href = "/atelier-cave-light.css"
        head.appendChild(link)
        title.textContent = "wastebin - light"
    }
    if (pathname.length == "32") {
        fetch(`raw/${pathname}`).then(res => res.text()).then(res => {
            textarea.style.display = "none" //隐藏textarea
            document.querySelector("code").textContent = res
            hljs.highlightAll()
        })
    } else if (pathname.length != 0) {
        window.location.replace("/")
    } else { //直接访问index.html
        document.querySelector("pre").style.display = "none"
    }
    document.addEventListener("keydown", (e) => {
        if (e.key == "s" && e.ctrlKey) {
            e.preventDefault()
            fetch("documents", {
                method: "POST",
                body: new URLSearchParams({data: document.querySelector("textarea").value})
            }).then(res => res.json()).then(res => {
                if (res.success) {
                    window.location.assign(`${res.filename}`)
                } else {
                    alert("未知错误")
                }
            })
        } else if (e.key == "b" && e.ctrlKey) {
            e.preventDefault()
            if (window.location.hash == "#light") {
                window.location.hash = "#dark"
                window.location.reload()
            } else {
                window.location.hash = "#light"
                window.location.reload()
            }
        } else if (e.key == "r" && e.ctrlKey) {
            e.preventDefault()
            if (pathname.length == "32") {
                window.location.assign(`${window.location.origin}/raw${window.location.pathname}`)
            }
        }
    })
</script>
<style>
    @import url("/cascadia-code.css");
    * {
        font-family: 'Cascadia Code', monospace;
    }
    body, html {
        box-sizing: border-box;
        width: 100%;
        height: 100%;
        background-color: #efecf4;
        margin: 0;
        padding: 0;
    }
    textarea {
        width: 100%;
        height: 100%;
        background-color: transparent;
        color: black;
        outline: none;
        resize: none;
        border-style: none;
        padding: 16px;
    }
</style>